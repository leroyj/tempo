# Dockerfile pour le développement
FROM node:24-alpine

WORKDIR /app

# Installer les dépendances système si nécessaire
RUN apk add --no-cache python3 make g++

# Copier les fichiers de dépendances
COPY package*.json ./
COPY tsconfig.json ./
COPY nest-cli.json ./

# Installer toutes les dépendances (dev + prod)
RUN npm install --legacy-peer-deps

# Copier le reste du code (après installation pour meilleur cache Docker)
COPY . .

# Exposer le port
EXPOSE 3000

# Démarrer en mode watch
CMD ["npm", "run", "start:dev"]

